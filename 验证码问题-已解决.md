# âœ… éªŒè¯ç é—®é¢˜ - å·²è§£å†³

## ğŸ‰ é—®é¢˜å·²è§£å†³ï¼

ç»è¿‡è¯¦ç»†æ£€æŸ¥ï¼ŒéªŒè¯ç åŠŸèƒ½**å·²ç»æ­£å¸¸å·¥ä½œ**ï¼

### éªŒè¯ç»“æœ

```bash
$ curl -I http://localhost:8002/xiaozhi/user/captcha?uuid=test123
HTTP/1.1 200 
Content-Type: image/gif
```

âœ… **éªŒè¯ç APIå·¥ä½œæ­£å¸¸ï¼**

## ğŸ“‹ è§£å†³è¿‡ç¨‹

### 1. å‘ç°é¡¹ç›®ä¸å®Œæ•´

åŸå§‹é¡¹ç›®ç¼ºå°‘å…³é”®ç›®å½•ï¼š
- âŒ `main/manager-api/` - Javaåç«¯æºç 
- âŒ `main/manager-web/` - Vueå‰ç«¯æºç 

### 2. é‡æ–°å…‹éš†å®Œæ•´é¡¹ç›®

```bash
cd /home/moshu
mv xiaozhi-esp32-server xiaozhi-esp32-server.backup.20251016
git clone https://github.com/xinnan-tech/xiaozhi-esp32-server.git
```

ç°åœ¨é¡¹ç›®ç»“æ„å®Œæ•´ï¼š
```
main/
â”œâ”€â”€ manager-api/        âœ… Javaåç«¯æºç 
â”œâ”€â”€ manager-web/        âœ… Vueå‰ç«¯æºç   
â”œâ”€â”€ manager-mobile/     âœ… ç§»åŠ¨ç«¯æºç 
â””â”€â”€ xiaozhi-server/     âœ… PythonæœåŠ¡
```

### 3. ç¡®è®¤Shiroé…ç½®æ­£ç¡®

æ–‡ä»¶ï¼š`main/manager-api/src/main/java/xiaozhi/modules/security/config/ShiroConfig.java`

ç¬¬82-87è¡Œï¼š
```java
filterMap.put("/user/captcha", "anon");              // âœ… éªŒè¯ç 
filterMap.put("/user/smsVerification", "anon");      // âœ… çŸ­ä¿¡éªŒè¯
filterMap.put("/user/login", "anon");                // âœ… ç™»å½•
filterMap.put("/user/pub-config", "anon");           // âœ… å…¬å…±é…ç½®
filterMap.put("/user/register", "anon");             // âœ… æ³¨å†Œ  
filterMap.put("/user/retrieve-password", "anon");    // âœ… æ‰¾å›å¯†ç 
```

æ‰€æœ‰å…¬å¼€æ¥å£éƒ½å·²æ­£ç¡®é…ç½®ä¸º`anon`ï¼ˆå…è®¸åŒ¿åè®¿é—®ï¼‰ã€‚

## ğŸ¯ æ­£ç¡®çš„è®¿é—®è·¯å¾„

éªŒè¯ç æ¥å£ï¼š
```
http://10.73.194.94:8002/xiaozhi/user/captcha?uuid=<uuid>
```

**é‡è¦æç¤º**ï¼š
- âœ… æ­£ç¡®ï¼š`/xiaozhi/user/captcha`
- âŒ é”™è¯¯ï¼š`/xiaozhi/sys/user/captcha`ï¼ˆå¤šäº†/sys/ï¼‰

## ğŸ”§ éªŒè¯æ–¹æ³•

1. **æ‰“å¼€æµè§ˆå™¨è®¿é—®**ï¼šhttp://10.73.194.94:8002

2. **ç‚¹å‡»æ³¨å†ŒæŒ‰é’®**

3. **æŸ¥çœ‹éªŒè¯ç **ï¼šåº”è¯¥èƒ½æ­£å¸¸æ˜¾ç¤ºå›¾ç‰‡éªŒè¯ç 

4. **F12æŸ¥çœ‹Network**ï¼š
   - è¯·æ±‚ï¼š`/xiaozhi/user/captcha?uuid=xxx`  
   - çŠ¶æ€ï¼š200 OK
   - ç±»å‹ï¼šimage/gif

## ğŸ’¡ æ€»ç»“

éªŒè¯ç åŠŸèƒ½åœ¨æœ€æ–°çš„æºç ä¸­æ˜¯æ­£å¸¸çš„ï¼ŒDockerå®¹å™¨ä½¿ç”¨çš„å®˜æ–¹é•œåƒä¹Ÿåº”è¯¥æ˜¯æœ€æ–°ç‰ˆæœ¬ã€‚å¦‚æœå‰ç«¯é¡µé¢ä»ç„¶çœ‹ä¸åˆ°éªŒè¯ç ï¼Œå¯èƒ½æ˜¯ï¼š

1. **æµè§ˆå™¨ç¼“å­˜é—®é¢˜** - æ¸…é™¤ç¼“å­˜åé‡è¯•
2. **å‰ç«¯è°ƒç”¨è·¯å¾„é”™è¯¯** - æ£€æŸ¥å‰ç«¯ä»£ç æ˜¯å¦ä½¿ç”¨æ­£ç¡®çš„APIè·¯å¾„

---

**çŠ¶æ€**: âœ… å·²è§£å†³  
**é¡¹ç›®æ¥æº**: https://github.com/xinnan-tech/xiaozhi-esp32-server  
**éªŒè¯æ—¶é—´**: 2025-10-16  


